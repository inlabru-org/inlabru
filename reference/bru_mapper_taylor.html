<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mapper for linear Taylor approximations — bru_mapper_taylor • inlabru</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mapper for linear Taylor approximations — bru_mapper_taylor"><meta name="description" content="Provides a pre-computed affine mapping,
internally used to represent and evaluate linearisation information.
The state0 information indicates for which state the offset was evaluated;
The affine mapper output is defined as
effect(state) = offset + jacobian %*% (state - state0)"><meta property="og:description" content="Provides a pre-computed affine mapping,
internally used to represent and evaluate linearisation information.
The state0 information indicates for which state the offset was evaluated;
The affine mapper output is defined as
effect(state) = offset + jacobian %*% (state - state0)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inlabru</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.11.1.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-general-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">General examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-general-examples"><li><h6 class="dropdown-header" data-toc-skip>Basic examples</h6></li>
    <li><a class="dropdown-item" href="../articles/random_fields.html">Random field models in 1D</a></li>
    <li><a class="dropdown-item" href="../articles/random_fields_2d.html">Spatial random field models in 2D</a></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Publications</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/component.html">Defining a model component</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special models and techniques</h6></li>
    <li><a class="dropdown-item" href="../articles/svc.html">Spatially varying coefficient models</a></li>
    <li><a class="dropdown-item" href="../articles/zip_zap_models.html">ZIP and ZAP count models (zero-inflation)</a></li>
    <li><a class="dropdown-item" href="../articles/prediction_scores.html">Computing posterior prediction scores</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/articles.html">Full articles list</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-point-processes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Point processes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-point-processes"><li><h6 class="dropdown-header" data-toc-skip>Point process examples</h6></li>
    <li><a class="dropdown-item" href="../articles/1d_lgcp.html">LGCPs - An example in one dimension</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp.html">LGCPs - An example in two dimensions (sf version)</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_sp.html">LGCPs - An example in two dimensions (sp version)</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_covars.html">LGCPs - Spatial covariates</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_distancesampling.html">LGCPs - Distance sampling</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_plotsampling.html">LGCPs - Plot sampling</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_multilikelihood.html">LGCPs - Multiple likelihoods</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_spatiotemporal.html">LGCPs - An example in space and time</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_residuals.html">LGCPs - Residuals</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-technical-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Technical articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-technical-articles"><li><h6 class="dropdown-header" data-toc-skip>Mapper techniques</h6></li>
    <li><a class="dropdown-item" href="../articles/bru_mapper.html">Customised model component with the bru_mapper system</a></li>
    <li><a class="dropdown-item" href="../articles/mesh_mapping.html">Converting inla.spde.make.A calls to the bru_mapper system</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Theory and technical documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/Apptainer.html">Installation of INLA and inlabru with Apptainer on HPC</a></li>
    <li><a class="dropdown-item" href="../articles/method.html">The iterative linearised inlabru method</a></li>
    <li><a class="dropdown-item" href="../articles/linearapprox.html">A nonlinear model approximation example</a></li>
    <li><a class="dropdown-item" href="../articles/devel_flow.html">Code internal flow diagrams for model evaluation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/inlabru-org/inlabru/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mapper for linear Taylor approximations</h1>
      <small class="dont-index">Source: <a href="https://github.com/inlabru-org/inlabru/blob/devel/R/mappers.R" class="external-link"><code>R/mappers.R</code></a></small>
      <div class="d-none name"><code>bru_mapper_taylor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides a pre-computed affine mapping,
internally used to represent and evaluate linearisation information.
The <code>state0</code> information indicates for which state the <code>offset</code> was evaluated;
The affine mapper output is defined as
<code>effect(state) = offset + jacobian %*% (state - state0)</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bru_mapper_taylor</span><span class="op">(</span></span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  jacobian <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  state0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  values_mapper <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bru_mapper_taylor'</span></span>
<span><span class="fu"><a href="bru_mapper_generics.html">ibm_n</a></span><span class="op">(</span><span class="va">mapper</span>, inla_f <span class="op">=</span> <span class="cn">FALSE</span>, multi <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bru_mapper_taylor'</span></span>
<span><span class="fu"><a href="bru_mapper_generics.html">ibm_n_output</a></span><span class="op">(</span><span class="va">mapper</span>, <span class="va">input</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bru_mapper_taylor'</span></span>
<span><span class="fu"><a href="bru_mapper_generics.html">ibm_values</a></span><span class="op">(</span><span class="va">mapper</span>, inla_f <span class="op">=</span> <span class="cn">FALSE</span>, multi <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bru_mapper_taylor'</span></span>
<span><span class="fu"><a href="bru_mapper_generics.html">ibm_jacobian</a></span><span class="op">(</span><span class="va">mapper</span>, <span class="va">...</span>, multi <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'bru_mapper_taylor'</span></span>
<span><span class="fu"><a href="bru_mapper_generics.html">ibm_eval</a></span><span class="op">(</span><span class="va">mapper</span>, input <span class="op">=</span> <span class="cn">NULL</span>, state <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>For <code>bru_mapper_taylor</code>, an offset vector evaluated
at <code>state0</code>.
May be <code>NULL</code>, interpreted as an all-zero vector of length determined by
a non-null Jacobian.</p></dd>


<dt id="arg-jacobian">jacobian<a class="anchor" aria-label="anchor" href="#arg-jacobian"></a></dt>
<dd><p>For <code>bru_mapper_taylor()</code>, the Jacobian matrix,
evaluated at <code>state0</code>, or, a named list of such matrices.
May be <code>NULL</code> or an empty list, for a constant mapping.</p></dd>


<dt id="arg-state-">state0<a class="anchor" aria-label="anchor" href="#arg-state-"></a></dt>
<dd><p>For <code>bru_mapper_taylor</code>, the state the linearisation
was evaluated at, or a list of length matching the <code>jacobian</code> list.
<code>NULL</code> is interpreted as 0.</p></dd>


<dt id="arg-values-mapper">values_mapper<a class="anchor" aria-label="anchor" href="#arg-values-mapper"></a></dt>
<dd><p>mapper object to be used for <code>ibm_n</code> and
<code>ibm_values</code> for <code>inla_f=TRUE</code> (experimental, currently unused)</p></dd>


<dt id="arg-mapper">mapper<a class="anchor" aria-label="anchor" href="#arg-mapper"></a></dt>
<dd><p>A mapper S3 object, inheriting from <code>bru_mapper</code>.</p></dd>


<dt id="arg-inla-f">inla_f<a class="anchor" aria-label="anchor" href="#arg-inla-f"></a></dt>
<dd><p>logical; when <code>TRUE</code> for <code><a href="bru_mapper_generics.html">ibm_n()</a></code> and <code><a href="bru_mapper_generics.html">ibm_values()</a></code>, the
result must be compatible with the <code>INLA::f(...)</code> and corresponding
<code>INLA::inla.stack(...)</code> constructions.  For <code>ibm_{eval,jacobian,linear}</code>,
the <code>input</code> interpretation may be different.
Implementations do not normally need to do anything different, except
for mappers of the type needed for hidden multicomponent models such
as "bym2", which can be handled by <code>bru_mapper_collect</code>.</p></dd>


<dt id="arg-multi">multi<a class="anchor" aria-label="anchor" href="#arg-multi"></a></dt>
<dd><p>logical;
If <code>TRUE</code> (or positive), recurse one level into sub-mappers</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to other methods</p></dd>


<dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>Data input for the mapper.</p></dd>


<dt id="arg-state">state<a class="anchor" aria-label="anchor" href="#arg-state"></a></dt>
<dd><p>A vector of latent state values for the mapping,
of length <code>ibm_n(mapper, inla_f = FALSE)</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>The <code>ibm_eval.bru_mapper_taylor()</code> evaluates linearised
mapper information at the given <code>state</code>. The <code>input</code> argument is ignored,
so that the usual argument order
<code>ibm_eval(mapper, input, state)</code> syntax can be used, but also
<code>ibm_eval(mapper, state = state)</code>.  For a mapper with a named jacobian list,
the <code>state</code> argument must also be a named list.  If <code>state</code> is <code>NULL</code>,
all-zero is assumed.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="bru_mapper.html">bru_mapper</a>, <a href="bru_mapper_generics.html">bru_mapper_generics</a></p>
<p>Other mappers:
<code><a href="bru_get_mapper.html">bru_get_mapper</a>()</code>,
<code><a href="bru_mapper.html">bru_mapper</a>()</code>,
<code><a href="bru_mapper_fm_mesh_1d.html">bru_mapper.fm_mesh_1d</a>()</code>,
<code><a href="bru_mapper_fm_mesh_2d.html">bru_mapper.fm_mesh_2d</a>()</code>,
<code><a href="bru_mapper_aggregate.html">bru_mapper_aggregate</a>()</code>,
<code><a href="bru_mapper_collect.html">bru_mapper_collect</a>()</code>,
<code><a href="bru_mapper_const.html">bru_mapper_const</a>()</code>,
<code><a href="bru_mapper_factor.html">bru_mapper_factor</a>()</code>,
<code><a href="bru_mapper_generics.html">bru_mapper_generics</a></code>,
<code><a href="bru_mapper_harmonics.html">bru_mapper_harmonics</a>()</code>,
<code><a href="bru_mapper_index.html">bru_mapper_index</a>()</code>,
<code><a href="bru_mapper_linear.html">bru_mapper_linear</a>()</code>,
<code><a href="bru_mapper_logsumexp.html">bru_mapper_logsumexp</a>()</code>,
<code><a href="bru_mapper_marginal.html">bru_mapper_marginal</a>()</code>,
<code><a href="bru_mapper_matrix.html">bru_mapper_matrix</a>()</code>,
<code><a href="bru_mapper_mesh_B.html">bru_mapper_mesh_B</a>()</code>,
<code><a href="bru_mapper_multi.html">bru_mapper_multi</a>()</code>,
<code><a href="bru_mapper_pipe.html">bru_mapper_pipe</a>()</code>,
<code><a href="bru_mapper_scale.html">bru_mapper_scale</a>()</code>,
<code><a href="bru_mapper_shift.html">bru_mapper_shift</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">bru_mapper_taylor</span><span class="op">(</span></span></span>
<span class="r-in"><span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  jacobian <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  state0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bru_mapper_generics.html">ibm_eval2</a></span><span class="op">(</span><span class="va">m</span>, state <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $offset</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  7  9 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $jacobian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    2    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    3    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Finn Lindgren, Fabian E. Bachl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

