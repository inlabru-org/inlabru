<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Latent model component construction — component • inlabru</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Latent model component construction — component"><meta name="description" content="Similar to glm(), gam() and inla(), bru() models can be constructed via
a formula-like syntax, where each latent effect is specified. However, in
addition to the parts of the syntax compatible with INLA::inla, bru
components offer additional functionality which facilitates modelling, and
the predictor expression can be specified separately, allowing more complex
and non-linear predictors to be defined. The formula syntax is just a way to
allow all model components to be defined in a single line of code, but the
definitions can optionally be split up into separate component definitions.
See Details for more information.
The component methods all rely on the component.character() method, that
defines a model component with a given label/name. The user usually
doesn't need to call these methods directly, but can instead supply a
formula expression that can be interpreted by the component_list.formula()
method, called inside bru()."><meta property="og:description" content="Similar to glm(), gam() and inla(), bru() models can be constructed via
a formula-like syntax, where each latent effect is specified. However, in
addition to the parts of the syntax compatible with INLA::inla, bru
components offer additional functionality which facilitates modelling, and
the predictor expression can be specified separately, allowing more complex
and non-linear predictors to be defined. The formula syntax is just a way to
allow all model components to be defined in a single line of code, but the
definitions can optionally be split up into separate component definitions.
See Details for more information.
The component methods all rely on the component.character() method, that
defines a model component with a given label/name. The user usually
doesn't need to call these methods directly, but can instead supply a
formula expression that can be interpreted by the component_list.formula()
method, called inside bru()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inlabru</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.11.1.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-general-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">General examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-general-examples"><li><h6 class="dropdown-header" data-toc-skip>Basic examples</h6></li>
    <li><a class="dropdown-item" href="../articles/random_fields.html">Random field models in 1D</a></li>
    <li><a class="dropdown-item" href="../articles/random_fields_2d.html">Spatial random field models in 2D</a></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Publications</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/component.html">Defining a model component</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special models and techniques</h6></li>
    <li><a class="dropdown-item" href="../articles/svc.html">Spatially varying coefficient models</a></li>
    <li><a class="dropdown-item" href="../articles/zip_zap_models.html">ZIP and ZAP count models (zero-inflation)</a></li>
    <li><a class="dropdown-item" href="../articles/prediction_scores.html">Computing posterior prediction scores</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/articles.html">Full articles list</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-point-processes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Point processes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-point-processes"><li><h6 class="dropdown-header" data-toc-skip>Point process examples</h6></li>
    <li><a class="dropdown-item" href="../articles/1d_lgcp.html">LGCPs - An example in one dimension</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp.html">LGCPs - An example in two dimensions (sf version)</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_sp.html">LGCPs - An example in two dimensions (sp version)</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_covars.html">LGCPs - Spatial covariates</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_distancesampling.html">LGCPs - Distance sampling</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_plotsampling.html">LGCPs - Plot sampling</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_multilikelihood.html">LGCPs - Multiple likelihoods</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_spatiotemporal.html">LGCPs - An example in space and time</a></li>
    <li><a class="dropdown-item" href="../articles/2d_lgcp_residuals.html">LGCPs - Residuals</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-technical-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Technical articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-technical-articles"><li><h6 class="dropdown-header" data-toc-skip>Mapper techniques</h6></li>
    <li><a class="dropdown-item" href="../articles/bru_mapper.html">Customised model component with the bru_mapper system</a></li>
    <li><a class="dropdown-item" href="../articles/mesh_mapping.html">Converting inla.spde.make.A calls to the bru_mapper system</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Theory and technical documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/Apptainer.html">Installation of INLA and inlabru with Apptainer on HPC</a></li>
    <li><a class="dropdown-item" href="../articles/method.html">The iterative linearised inlabru method</a></li>
    <li><a class="dropdown-item" href="../articles/linearapprox.html">A nonlinear model approximation example</a></li>
    <li><a class="dropdown-item" href="../articles/devel_flow.html">Code internal flow diagrams for model evaluation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/inlabru-org/inlabru/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Latent model component construction</h1>
      <small class="dont-index">Source: <a href="https://github.com/inlabru-org/inlabru/blob/devel/R/effect.R" class="external-link"><code>R/effect.R</code></a></small>
      <div class="d-none name"><code>component.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Similar to <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>, <code>gam()</code> and <code><a href="https://rdrr.io/pkg/INLA/man/inla.html" class="external-link">inla()</a></code>, <code><a href="bru.html">bru()</a></code> models can be constructed via
a formula-like syntax, where each latent effect is specified. However, in
addition to the parts of the syntax compatible with <code><a href="https://rdrr.io/pkg/INLA/man/inla.html" class="external-link">INLA::inla</a></code>, <code>bru</code>
components offer additional functionality which facilitates modelling, and
the predictor expression can be specified separately, allowing more complex
and non-linear predictors to be defined. The formula syntax is just a way to
allow all model components to be defined in a single line of code, but the
definitions can optionally be split up into separate component definitions.
See Details for more information.</p>
<p>The <code>component</code> methods all rely on the <code>component.character()</code> method, that
defines a model component with a given label/name. The user usually
doesn't need to call these methods directly, but can instead supply a
formula expression that can be interpreted by the <code><a href="component_list.html">component_list.formula()</a></code>
method, called inside <code><a href="bru.html">bru()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">component</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'character'</span></span>
<span><span class="fu">component</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mapper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main_layer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main_selector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  values <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  season.length <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  copy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights_layer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights_selector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  group_mapper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_layer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_selector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ngroup <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control.group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replicate <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  replicate_mapper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replicate_layer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replicate_selector <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  marginal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  A.msk <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  envir_extra <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Parameters passed on to other methods</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A character label for the component</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p><code>main</code> takes an R expression that evaluates to where the latent variables
should be evaluated (coordinates, indices, continuous scalar (for rw2 etc)).
Arguments starting with weights, group, replicate behave similarly to main,
but for the corresponding features of <code><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">INLA::f()</a></code>.</p></dd>


<dt id="arg-weights-weights-layer-weights-selector">weights, weights_layer, weights_selector<a class="anchor" aria-label="anchor" href="#arg-weights-weights-layer-weights-selector"></a></dt>
<dd><p>Optional specification of effect scaling weights.
Same syntax as for <code>main</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Either one of "const" (same as "offset"), "factor_full",
"factor_contrast", "linear",
"fixed", or a model name or
object accepted by INLA's <code>f</code> function. If set to NULL, then "linear" is used
for vector inputs, and "fixed" for matrix input (converted internally to
an iid model with fixed precision)</p></dd>


<dt id="arg-mapper">mapper<a class="anchor" aria-label="anchor" href="#arg-mapper"></a></dt>
<dd><p>Information about how to do the mapping from the values evaluated in <code>main</code>,
and to the latent variables. Auto-detects spde model objects in model and
extracts the mesh object to use as the mapper, and auto-generates mappers
for indexed models. (Default: NULL, for auto-determination)</p></dd>


<dt id="arg-main-layer-main-selector">main_layer, main_selector<a class="anchor" aria-label="anchor" href="#arg-main-layer-main-selector"></a></dt>
<dd><p>The <code>_layer</code> input should evaluate to a numeric index or character name or
vector of which
layer/variable to extract from a covariate data object given in <code>main</code>.
(Default: NULL if <code>_selector</code> is given. Otherwise the effect component name,
if it exists in the covariate object, and otherwise the first column of
the covariate data frame)</p>
<p>The <code>_selector</code> value should be a character name of a variable
whose contents determines which layer to extract from a covariate for each
data point. (Default: NULL)</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>The number of latent variables in the model. Should be auto-detected
for most or all models (Default: NULL, for auto-detection).
An error is given if it can't figure it out by itself.</p></dd>


<dt id="arg-values">values<a class="anchor" aria-label="anchor" href="#arg-values"></a></dt>
<dd><p>Specifies for what covariate/index values INLA should build
the latent model. Normally generated internally based on the mapping details.
(Default: NULL, for auto-determination)</p></dd>


<dt id="arg-season-length">season.length<a class="anchor" aria-label="anchor" href="#arg-season-length"></a></dt>
<dd><p>Passed on to <code><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">INLA::f()</a></code> for model <code>"seasonal"</code>
(TODO: check if this parameter is still fully handled)</p></dd>


<dt id="arg-copy">copy<a class="anchor" aria-label="anchor" href="#arg-copy"></a></dt>
<dd><p>character; label of other component that this component should
be a copy of. If the <code>fixed = FALSE</code>, a scaling constant is estimated, via a
hyperparameter. If <code>fixed = TRUE</code>, the component scaling is fixed, by
default to 1; for fixed scaling, it's more efficient to express the scaling
in the predictor expression instead of making a copy component.</p></dd>


<dt id="arg-group-group-mapper-group-layer-group-selector-ngroup">group, group_mapper, group_layer, group_selector, ngroup<a class="anchor" aria-label="anchor" href="#arg-group-group-mapper-group-layer-group-selector-ngroup"></a></dt>
<dd><p>Optional specification of kronecker/group model indexing.</p></dd>


<dt id="arg-control-group">control.group<a class="anchor" aria-label="anchor" href="#arg-control-group"></a></dt>
<dd><p><code>list</code> of kronecker/group model parameters, currently
passed directly on to <code><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">INLA::f</a></code></p></dd>


<dt id="arg-replicate-replicate-mapper-replicate-layer-replicate-selector-nrep">replicate, replicate_mapper, replicate_layer, replicate_selector, nrep<a class="anchor" aria-label="anchor" href="#arg-replicate-replicate-mapper-replicate-layer-replicate-selector-nrep"></a></dt>
<dd><p>Optional specification of indices for an independent
replication model. Same syntax as for <code>main</code></p></dd>


<dt id="arg-marginal">marginal<a class="anchor" aria-label="anchor" href="#arg-marginal"></a></dt>
<dd><p>May specify a <code><a href="bru_mapper_marginal.html">bru_mapper_marginal()</a></code> mapper,
that is applied before scaling by <code>weights</code>.</p></dd>


<dt id="arg-a-msk">A.msk<a class="anchor" aria-label="anchor" href="#arg-a-msk"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> and has no effect.</p></dd>


<dt id="arg--envir">.envir<a class="anchor" aria-label="anchor" href="#arg--envir"></a></dt>
<dd><p>Evaluation environment</p></dd>


<dt id="arg-envir-extra">envir_extra<a class="anchor" aria-label="anchor" href="#arg-envir-extra"></a></dt>
<dd><p>TODO: check/fix this parameter.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>As shorthand, <code><a href="bru.html">bru()</a></code> will understand basic additive formulae describing fixed effect
models. For instance, the
components specification <code>y ~ x</code> will define the linear combination of an
effect named <code>x</code> and an intercept to
the response <code>y</code> with respect to the likelihood family stated when calling <code><a href="bru.html">bru()</a></code>. Mathematically,
the linear predictor \(\eta\) would be written down as</p>
<p>$$\eta = \beta * x + c,$$</p>
<p>where:</p>
<dl><dt>\(c\)</dt>
<dd><p>is the <em>intercept</em></p></dd>

<dt>\(x\)</dt>
<dd><p>is a <em>covariate</em></p></dd>

<dt>\(\beta\)</dt>
<dd><p>is a <em>latent variable</em> associated with \(x\) and</p></dd>

<dt>\(\psi = \beta * x\)</dt>
<dd><p>is called the <em>effect</em> of \(x\)</p></dd>


</dl><p>A problem that arises when using this kind of R formula is that it does not
clearly reflect the mathematical
formula. For instance, when providing the formula to inla, the resulting
object will refer to the random
effect \(\psi = \beta * x \) as <code>x</code>.
Hence, it is not clear when <code>x</code> refers to the covariate
or the effect of the covariate.</p>
<p>The <code>component.character</code> method is inlabru's equivalent to INLA's
<code>f</code> function but adds functionality that is unique to inlabru.</p>
<p>Deprecated parameters:</p><ul><li><p>map: Use <code>main</code> instead.</p></li>
<li><p>mesh: Use <code>mapper</code> instead.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="naming-random-effects">Naming random effects<a class="anchor" aria-label="anchor" href="#naming-random-effects"></a></h2>



<p>In INLA, the <code><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f()</a></code> notation is used to define more complex models, but
a simple linear effect model can also be expressed as</p>
<ul><li><p><code>formula = y ~ f(x, model = "linear")</code>,</p></li>
</ul><p>where <code><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f()</a></code> is the inla specific function to set up random effects of all kinds. The underlying
predictor would again be \(\eta = \beta * x + c\) but the result of fitting the model would state
<code>x</code> as the random effect's name. bru allows rewriting this formula in order to explicitly state
the name of the random effect and the name of the associated covariate. This is achieved by replacing <code>f</code>
with an arbitrary name that we wish to assign to the effect, e.g.</p>
<ul><li><p><code>components = y ~ psi(x, model = "linear")</code>.</p></li>
</ul><p>Being able to discriminate between \(x\) and \(\psi\) is relevant because of two functionalities
bru offers. The formula parameters of both <code><a href="bru.html">bru()</a></code> and the prediction method <a href="predict.bru.html">predict.bru</a>
are interpreted in the mathematical sense. For instance, <code>predict</code> may be used to analyze the
analytical combination of the covariate \(x\) and the intercept using</p>
<ul><li><p><code>predict(fit, data.frame(x=2)), ~ exp(psi + Intercept)</code>.</p></li>
</ul><p>which corresponds to the mathematical expression e <sup>β + c</sup>.</p>
<p>On the other hand, predict may be used to only look at a transformation of
the latent variable \(\beta_\psi\)</p>
<ul><li><p><code>predict(fit, NULL, ~ exp(psi_latent))</code>.</p></li>
</ul><p>which corresponds to the mathematical expression e <sup>β</sup>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other component constructors:
<code><a href="component_list.html">component_list</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Fabian E. Bachl <a href="mailto:bachlfab@gmail.com">bachlfab@gmail.com</a> and
Finn Lindgren <a href="mailto:Finn.Lindgren@gmail.com">Finn.Lindgren@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># As an example, let us create a linear component. Here, the component is</span></span></span>
<span class="r-in"><span><span class="co"># called "myLinearEffectOfX" while the covariate the component acts on is</span></span></span>
<span class="r-in"><span><span class="co"># called "x". Note that a list of components is returned because the</span></span></span>
<span class="r-in"><span><span class="co"># formula may define multiple components</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="component_list.html">component_list</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">myLinearEffectOfX</span><span class="op">(</span>main <span class="op">=</span> <span class="va">x</span>, model <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Label:	myLinearEffectOfX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type:	main = linear, group = exchangeable, replicate = iid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Input:	main = x, group = 1L, replicate = 1L, NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Map: Not yet initialised</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   INLA formula:	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ~ . + f(myLinearEffectOfX, model =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       BRU_myLinearEffectOfX_main_model)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Label:	Intercept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type:	main = linear, group = exchangeable, replicate = iid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Input:	main = 1, group = 1L, replicate = 1L, NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Map: Not yet initialised</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   INLA formula:	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ~ . + f(Intercept, model = BRU_Intercept_main_model)</span>
<span class="r-in"><span><span class="co"># Equivalent shortcuts:</span></span></span>
<span class="r-in"><span><span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="component_list.html">component_list</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">myLinearEffectOfX</span><span class="op">(</span><span class="va">x</span>, model <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="component_list.html">component_list</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">myLinearEffectOfX</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Individual component</span></span></span>
<span class="r-in"><span><span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"myLinearEffectOfX"</span>, main <span class="op">=</span> <span class="va">x</span>, model <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Label:	myLinearEffectOfX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type:	main = linear, group = exchangeable, replicate = iid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Input:	main = x, group = 1L, replicate = 1L, NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Map: Not yet initialised</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   INLA formula:	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ~ . + f(myLinearEffectOfX, model =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       BRU_myLinearEffectOfX_main_model)</span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="bru_safe_inla.html">bru_safe_inla</a></span><span class="op">(</span>quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># As an example, let us create a linear component. Here, the component is</span></span></span>
<span class="r-in"><span>  <span class="co"># called "myEffectOfX" while the covariate the component acts on is called "x":</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"myEffectOfX"</span>, main <span class="op">=</span> <span class="va">x</span>, model <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># A more complicated component:</span></span></span>
<span class="r-in"><span>  <span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"myEffectOfX"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="fu">INLA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.spde2.matern.html" class="external-link">inla.spde2.matern</a></span><span class="op">(</span><span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_mesh_1d.html" class="external-link">fm_mesh_1d</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compound fixed effect component, where x and z are in the input data.</span></span></span>
<span class="r-in"><span>  <span class="co"># The formula will be passed on to MatrixModels::model.Matrix:</span></span></span>
<span class="r-in"><span>  <span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu">component</span><span class="op">(</span><span class="st">"eff"</span>, <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">:</span><span class="va">z</span>, model <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Label:	eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Type:	main = fixed, group = exchangeable, replicate = iid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Input:	main = ~-1 + x:z, group = 1L, replicate = 1L, NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Map: Not yet initialised</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   INLA formula:	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ~ . + f(eff, model = BRU_eff_main_model, hyper =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       BRU_eff_main_fixed_hyper)</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Finn Lindgren, Fabian E. Bachl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

